## Cookie & Session

### Cookie

    ● 클라이언트에 저장되는 데이터
        - 쿠키는 브라우저(클라이언트)에 저장되는 작은 데이터 조각이다.
        - 쿠키는 사용자가 웹 사이트를 방문할 때 서버가 브라우저에 보내며, 이후 같은 사이트를 방문할 때 쿠키에 저장된 정보를 서버로 다시 보낸다.

    ● 세션 ID 저장
        - 쿠키는 주로 서버에서 생성된 세션 ID를 저장하는 데 사용.
        - 서버는 쿠키를 통해 세션 ID를 클라이언트에게 전달하고, 클라이언트는 이후 요청할 때마다 이 세션ID를 포함한 쿠키를 서버에 다시 전송.
	
	쿠키는 서버에서 생성되어 클라이언트(ex, web browser)에게 전송된다. 
	이후 클라이언트는 해당 쿠키를 보관하고 있다가, 같은 서버로 요청을 보낼 때마다 그 쿠키를 서버로 다시 전송한다.

### 쿠키 흐름
	
	1. 서버가 쿠키 생성
		- 클라이언트가 서버에 요청을 보낼 떄, 서버는 필요에 따라 쿠키를 생성하여 클라이언트에게 응답한다.
		- 이때 Set-Cookie 헤더를 사용하여 쿠키를 클라이언트에게 전달한다.
			ex) 
				Set-Cookie : sessionId=abc123; Paht=/; HttpOnly; Secure

	2. 클라이언트가 쿠키 저장
		- 클라이언트(웹 브라우저)는 서버로부터 받은 쿠키를 저장. 이 쿠키는 해당 서버와의 통신에 사용할 수 있는 데이터로 유지.

	3.클라이언트가 다시 서버로 쿠키 전송
		- 클라이언트가 같은 서버로 다시 요청을 보낼 때, 저장된 쿠키를 함께 전송한다.
			이때, Cookie 헤더를 사용하여 쿠키를 포함시킨다.
			ex)
				Cookie : sessionId=abc123

	3. 서버가 쿠키를 사용
		- 서버는 클라이언트가 보낸 쿠키를 확인하고, 이를 통해 세션을 관리하거나 사용자 인증 등의 작업을 수행한다.

	● 예시 시나리오
		1. 사용자가 웹사이트에 로그인하면, 서버는 로그인 상태를 유지하기 위해 쿠키를 발급한다.
		2. 이 쿠키에는 사용자의 세션 ID 같은 정보가 포함될 수 있다.
		3. 사용자가 로그인한 후, 다시 같은 웹사이트에 접속할 때 브라우저는 해당 쿠키를 서버로 전송하여 사용자가 이미 로그인한 상태라는 것을 서버가 알 수 있게 한다.

	● 쿠키 주요 기능

	4. 로그인 유지
		- 사용자가 로그인한 후, 서버가 생성한 쿠키를 클라이언트에 전달.	
			이 쿠키는 다음 요청에서 로그인 상태를 유지하기 위해 사용된다.

			ex)	
				sessionId & accessToken 등의 쿠키를 통해 서버는 사용자가 인증된 상태임을 알 수 있다.
				
	5. 유저 식별(PK)
		- 쿠키에는 보통 사용자에 대한 고유 식별자(sessionId)가 포함되어 있다.
		- 이 세션 ID는 서버에서 사용자를 구분하는 primary key 같은 역할을 한다.
			클라이언트는 이 세션 ID를 포함한 쿠키를 서버로 다시 전송하고, 서버는 해당 ID를 보고 구별한다.

	6. 세션 관리
		- 서버는 각 사용자를 위한 세션을 생성하고, 세션 정보는 서버의 메모리나 DB에 저장된다.
			이때 사용자의 세션을 식별하기 위해 세션 ID를 쿠키로 관리한다.
		- 서버는 쿠키에 포함된 세션 ID를 이용해 해당 사용자의 세션 데이터를 찾아 요청을 처리.

	● 예시 시나리오 (유저 식별)
	
	7. 로그인 시,
		- 사용자가 로그인하면, 서버는 세션을 생성하고 sessionId=qwer123 같은 고유한 셋녀id를 포함한 쿠키를 클라이언트에게 전송한다.

	8. 다음 요청 시,
		- 사용자가 이후 서버로 요청할 때, 클라이언트는 Cookie: sessionId=qwer123 헤더를 서버로 전송
		- 서버는 이 qwer123 세션 ID를 기반으로, 해당 사용자가 어떤 사용자인지 식별하고 해당 유저와 관련된 데이터를 조회한다.  

### Session

	● 서버에 저장되는 데이터
        - 세션은 서버에서 관리되는 데이터로, 각 사용자가 서버에 접속할 떄마다 서버는 해당 사용자만의 세션을 생성한다. 
        - 이 세션에는 사용자의 상태나 정보가 저장된다.

    ● 고유 식별자 (SessionId)    
        - 서버는 사용자마다 고유한 세션 ID를 부여하여, 이 ID를 통해 사용자를 식별한다. 
        - SessionId는 서버에서만 사용자가 누구인지 확인하는 키가 된다.
        
    ● 상태 유지
        - 세션을 사용하면 사용자가 여러 페이지를 이동하거나 요청을 보내더라도, 서버는 사용자를 식별하고 이전에 발생한 상태(로그인 여부, 장바구니 상태 등)을 유지할 수 있다.

### session & cookie 관계

    1. 세션 생성
        - 사용자가 웹 서버에 처음 접속하면 서버는 세션을 생성하고, 고유한 세션 id를 부여한다.

    2. 쿠키를 통한 세션 id 저장
        - 서버는 생성된 세션 id를 쿠키에 담아 클라이언트에 전송한다.
            ex)
                Set-Cookie: sessionId=abc123와 같은 형태로 쿠키 생성이 된다.

    3. 다음 요청 시 쿠키 전달
        - 사용자는 다음 번에 같은 서버에 요청을 보낼 때, 브라우저는 서버가 준 쿠키(sessionId)를 함께 전송한다.
        - 이 과정은 cookie: sessionId=abc123 형태로 이루어진다.

    4. 세션 정보 조회
        - 서버는 클라이언트가 전송한 세션 id를 받아, 해당 id에 대응하는 세션 데이터를 서버에서 조회한다. 이를 통해 사용자가 누구인지, 로그인 상태인지, 어떤 작업을 했는지 등을 확인한다.    
        
### session & cookie 차이점        

| Session      | Cookie      | 
| ------------ | ------------|
| 서버에 저장   | 클라이언트(브라우저)에 저장 |
| 고유 식별자인 세션 ID를 통해 사용자 식별 | 세션 ID를 저장하고 서버에 전송 |
| 메모리나 데이터베이스에서 관리  | 브라우저에 파일 형태로 저장됨 |            
| 브라우저가 닫히거나 타임아웃 시 만료 | 만료 기간 설정에 따라 유지 또는 삭제 |
| 주로 중요한 사용자 상태 유지 (로그인 등) | 사용자 설정, 장바구니, 트레킹 등에 사용 |

### 예시 흐름 

    1. 사용자가 로그인
          - 서버는 세션을 생성하고 sessionId = adc123을 부여한다.
          - 서버는 클라이언트에게 Set-Cookie: sessionId=abc123 쿠키를 전송
          
    2. 다음 요청
          - 사용자가 서버에 다시 요청을 보낼 때, 클라이언트는 쿠키 sessionId=abc123을 서버로 보낸다.

    3. 서버에서 세션 확인
          - 서버는 이 sessionId = abc123을 기반으로, 해당 사용자의 세션 데이터를 조회하여 로그인 상태나 저장된 데이터를 유지한다.
    